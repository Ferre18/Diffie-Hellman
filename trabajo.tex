\documentclass[11pt]{article}
	\usepackage{listings}
	\usepackage{amsmath}
	\usepackage{amssymb}
	\usepackage[usenames,dvipsnames,svgnames,table]{xcolor}
	\usepackage[hidelinks=true]{hyperref}
	

	% BEGIN CUSTOM PYTHON
	% Fuente para python
	\DeclareFixedFont{\ttb}{T1}{txtt}{bx}{n}{11} % for bold
	\DeclareFixedFont{\ttm}{T1}{txtt}{m}{n}{11}  % for normal

	% Mis colores
	\definecolor{deepblue}{rgb}{0,0,0.5}
	\definecolor{deepred}{rgb}{0.6,0,0}
	\definecolor{deepgreen}{rgb}{0,0.5,0}

	% Python style for highlighting
	\newcommand\pythonstyle{\lstset{
	language=Python,
	basicstyle=\ttm,
	breakatwhitespace=false,         % Activarlo para que los saltos automáticos solo se apliquen en los espacios en blanco
  	breaklines=true,                 % Activa el salto de línea automático
  	tabsize=2,	                   % Establece el salto de las tabulaciones a 2 espacios
  	numbers=left,					% Pone el numero de lineas
	morekeywords={self},              % Add palabras que se pintan de azul
	keywordstyle=\ttb\color{deepblue},
	emph={DiffieHellman, compartir_clave_publica, generar_clave_secreta, __generarClaves__, __init__, compartir_clave_secreta, cifrar_xor, descifrar_xor},          % Add palabras que se pinten de rojo
	emphstyle=\ttb\color{deepred},    % Custom highlighting style
	stringstyle=\color{deepgreen},
	frame=tb,                         % Recuadro
	showstringspaces=false
	}}


	% Comando para escribir python directamente en el .tex
	\lstnewenvironment{python}[1][]
	{
	\pythonstyle
	\lstset{#1}
	}
	{}

	% Comando para escribir python desde un fichero externo
	\newcommand\pythonexternal[2][]{{
	\pythonstyle
	\lstinputlisting[#1]{#2}}}

	% Comando para escribir codigo suelto python en una linea
	\newcommand\pythoninline[1]{{\pythonstyle\lstinline!#1!}}
	% END CUSTOM PYTHON

    \title{\textbf{Intercambio de claves de Diffie y Hellman}}
    \author{Adrián Racero Serrano\\Juan Manuel Cardeñosa Borrego}
    \date{}
    
    \addtolength{\topmargin}{-3cm}
    \addtolength{\textheight}{3cm}
    
\renewcommand{\contentsname}{Índice}

\begin{document}

\maketitle
\thispagestyle{empty}

\newpage

\setcounter{page}{1}
\tableofcontents

\newpage

\section{Introducción}
El algoritmo Diffie-Hellman debe su nombre a sus creadores Whitfield Diffie y Martin Hellman. Creado en 1976, es uno de los protocolos de intercambio de claves más antiguos que todavía se siguen usando en la actualidad. Sus creadores fueron galardonados con el premio A.M. Turing 2015 por este trabajo, con el que revolucionaron por completo la seguridad informática.\\\\
Este algoritmo permite a dos usuarios cualesquiera intercambiar, de forma confidencial, una clave secreta \textit{K} (o de sesión) para posteriormente cifrar de forma simétrica los mensajes entre ellos dos.

\section{Algoritmo}
El funcionamiento de este algoritmo es más sencillo de lo que parece y se usa frecuentemente en protocolos y aplicaciones de encriptado de datos, como SSL (Secure Sockets Layer), SSH (Secure Shell) o VPN (Virtual Private Network). Este algoritmo permite que dos entidades (A y B) puedan generar una clave $K_{AB}$ de forma simultánea, y sin enviarla por el canal de comunicaciones. \\

1) Para ello, A y B necesitan establecer y compartir valores comunes, como un valor \textit{q} primo y una raíz primitiva $\alpha$  de \textit{q}. \\\\
Para todo primo \(q\) existe un elemento \(a \in (\mathbb{Z}/q\mathbb{Z})^{\times}\) con \(\text{ord}(a) = q - 1 = \phi(q) =  $\#$ (\mathbb{Z}/q\mathbb{Z})^{\times}\). En otras palabras,

\begin{center}
\((\mathbb{Z}/q\mathbb{Z})^{\times} = \{1, a, a^2, \ldots, a^{q-2}\}\).\\
\end{center}

Este \(a\) se llama una \textbf{raíz primitiva} módulo \(q\). Ejemplo:


\begin{center}
\textit{q = 3, $\alpha$ = 2; $2^1$ mod 3 = 1, $2^2$ mod 3 = 2}
\end{center}

2) Tanto A como B generan sus claves privadas ($X_{A/B}$) y públicas ($Y_{A/B}$) teniendo en cuenta que:  $ Y_{A} \equiv \alpha^{XA} \pmod{q}$, donde $0 \le X_A \le (q-1)$, $X_A$ es el logaritmo discreto de $Y_A$, y se representa $dlog_{\alpha,q}$ ($Y_A$). Por tanto, la efectividad del algoritmo depende de la dificultad de computar logaritmos discretos.
\\

3) Tanto A como B comparten sus respectivas claves públicas ($Y_A$/$Y_B$).\\

4) Tanto A como B generan la clave de sesión teniendo en cuenta: 
\begin{center}
\(K_{AB} = (Y_B)^{X_A} \mod q \rightarrow K_{AB} = (\alpha^{X_B})^{X_A} \mod q\)  \\
\(K_{AB} = (Y_A)^{X_B} \mod q \rightarrow K_{AB} = (\alpha^{X_A})^{X_B} \mod q\)  \\
\end{center}
Por tanto:
\begin{center}
$K_{AB} = \alpha^{X_B X_A} \mod q = \alpha^{X_A X_B}$
\end{center}


\section{Código}
La clase \pythoninline{DiffieHellman}: \\
\pythonexternal{code/algoritmo.py}
\ \\
Ejecucion del algoritmo:
\pythonexternal{code/ejecucion.py}
\ \\
Salida de la ejecución: \\
\lstinputlisting{code/salida.txt}

\section{Conclusión}
a

\end{document}









